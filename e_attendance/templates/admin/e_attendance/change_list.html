{% extends 'admin/change_list.html' %}

{% block object-tools-items %}
{{ block.super }}
<li>
    <a 
        id="generate-btn"
        href=""
        data-href="{% url 'e_attendance:generate_model_spreadsheet' %}?model_name={{ opts.model_name }}">
        Generate spreadsheet
    </a>
</li>

<script>
    let generateBtn = document.querySelector("#generate-btn")
    generateBtn.onclick = (e) => {
        e.preventDefault()
        let href = generateBtn.dataset.href
        if (location.search) {
            href += `&${location.search.slice(1)}`
        }
        location.href = href
    }
    
</script>
{% endblock %}
